{
  "createdUTC": "2020-05-29T18:06:30.651Z",
  "definitionIsPublic": false,
  "definitionName": "DL-SDD",
  "displayName": "DL-SDD Soil Moisture, Temperature and Salinity Profile For LoRaWAN®",
  "manufacturer": "Decentlab",
  "organizationId": "9f014719-4add-4989-ba0f-fc7edc44d893",
  "parser": "\n/* https://www.decentlab.com/products/soil-moisture-temperature-and-salinity-profile */\n\nvar decentlab_decoder = {\n  PROTOCOL_VERSION: 2,\n  SENSORS: [\n    {length: 18,\n     values: [{name: 'moisture_at_level_0',\n               displayName: 'Moisture at level 0',\n               convert: function (x) { return (x[0] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_1',\n               displayName: 'Moisture at level 1',\n               convert: function (x) { return (x[1] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_2',\n               displayName: 'Moisture at level 2',\n               convert: function (x) { return (x[2] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_3',\n               displayName: 'Moisture at level 3',\n               convert: function (x) { return (x[3] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_4',\n               displayName: 'Moisture at level 4',\n               convert: function (x) { return (x[4] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_5',\n               displayName: 'Moisture at level 5',\n               convert: function (x) { return (x[5] - 32768) / 100; },\n               unit: '%'},\n              {name: 'temperature_at_level_0',\n               displayName: 'Temperature at level 0',\n               convert: function (x) { return (x[6] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_1',\n               displayName: 'Temperature at level 1',\n               convert: function (x) { return (x[7] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_2',\n               displayName: 'Temperature at level 2',\n               convert: function (x) { return (x[8] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_3',\n               displayName: 'Temperature at level 3',\n               convert: function (x) { return (x[9] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_4',\n               displayName: 'Temperature at level 4',\n               convert: function (x) { return (x[10] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_5',\n               displayName: 'Temperature at level 5',\n               convert: function (x) { return (x[11] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'salinity_at_level_0',\n               displayName: 'Salinity at level 0',\n               convert: function (x) { return x[12] - 100; }},\n              {name: 'salinity_at_level_1',\n               displayName: 'Salinity at level 1',\n               convert: function (x) { return x[13] - 100; }},\n              {name: 'salinity_at_level_2',\n               displayName: 'Salinity at level 2',\n               convert: function (x) { return x[14] - 100; }},\n              {name: 'salinity_at_level_3',\n               displayName: 'Salinity at level 3',\n               convert: function (x) { return x[15] - 100; }},\n              {name: 'salinity_at_level_4',\n               displayName: 'Salinity at level 4',\n               convert: function (x) { return x[16] - 100; }},\n              {name: 'salinity_at_level_5',\n               displayName: 'Salinity at level 5',\n               convert: function (x) { return x[17] - 100; }}]},\n    {length: 18,\n     values: [{name: 'moisture_at_level_6',\n               displayName: 'Moisture at level 6',\n               convert: function (x) { return (x[0] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_7',\n               displayName: 'Moisture at level 7',\n               convert: function (x) { return (x[1] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_8',\n               displayName: 'Moisture at level 8',\n               convert: function (x) { return (x[2] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_9',\n               displayName: 'Moisture at level 9',\n               convert: function (x) { return (x[3] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_10',\n               displayName: 'Moisture at level 10',\n               convert: function (x) { return (x[4] - 32768) / 100; },\n               unit: '%'},\n              {name: 'moisture_at_level_11',\n               displayName: 'Moisture at level 11',\n               convert: function (x) { return (x[5] - 32768) / 100; },\n               unit: '%'},\n              {name: 'temperature_at_level_6',\n               displayName: 'Temperature at level 6',\n               convert: function (x) { return (x[6] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_7',\n               displayName: 'Temperature at level 7',\n               convert: function (x) { return (x[7] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_8',\n               displayName: 'Temperature at level 8',\n               convert: function (x) { return (x[8] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_9',\n               displayName: 'Temperature at level 9',\n               convert: function (x) { return (x[9] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_10',\n               displayName: 'Temperature at level 10',\n               convert: function (x) { return (x[10] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'temperature_at_level_11',\n               displayName: 'Temperature at level 11',\n               convert: function (x) { return (x[11] - 32768) / 100; },\n               unit: '°C'},\n              {name: 'salinity_at_level_6',\n               displayName: 'Salinity at level 6',\n               convert: function (x) { return x[12] - 100; }},\n              {name: 'salinity_at_level_7',\n               displayName: 'Salinity at level 7',\n               convert: function (x) { return x[13] - 100; }},\n              {name: 'salinity_at_level_8',\n               displayName: 'Salinity at level 8',\n               convert: function (x) { return x[14] - 100; }},\n              {name: 'salinity_at_level_9',\n               displayName: 'Salinity at level 9',\n               convert: function (x) { return x[15] - 100; }},\n              {name: 'salinity_at_level_10',\n               displayName: 'Salinity at level 10',\n               convert: function (x) { return x[16] - 100; }},\n              {name: 'salinity_at_level_11',\n               displayName: 'Salinity at level 11',\n               convert: function (x) { return x[17] - 100; }}]},\n    {length: 1,\n     values: [{name: 'battery_voltage',\n               displayName: 'Battery voltage',\n               convert: function (x) { return x[0] / 1000; },\n               unit: 'V'}]}\n  ],\n\n  read_int: function (bytes, pos) {\n    return (bytes[pos] << 8) + bytes[pos + 1];\n  },\n\n  decode: function (msg) {\n    var bytes = msg;\n    var i, j;\n    if (typeof msg === 'string') {\n      bytes = [];\n      for (i = 0; i < msg.length; i += 2) {\n        bytes.push(parseInt(msg.substring(i, i + 2), 16));\n      }\n    }\n\n    var version = bytes[0];\n    if (version != this.PROTOCOL_VERSION) {\n      return {error: \"protocol version \" + version + \" doesn't match v2\"};\n    }\n\n    var deviceId = this.read_int(bytes, 1);\n    var flags = this.read_int(bytes, 3);\n    var result = {'protocol_version': version, 'device_id': deviceId};\n    // decode payload\n    var pos = 5;\n    for (i = 0; i < this.SENSORS.length; i++, flags >>= 1) {\n      if ((flags & 1) !== 1)\n        continue;\n\n      var sensor = this.SENSORS[i];\n      var x = [];\n      // convert data to 16-bit integer array\n      for (j = 0; j < sensor.length; j++) {\n        x.push(this.read_int(bytes, pos));\n        pos += 2;\n      }\n\n      // decode sensor values\n      for (j = 0; j < sensor.values.length; j++) {\n        var value = sensor.values[j];\n        if ('convert' in value) {\n          result[value.name] = {displayName: value.displayName,\n                                value: value.convert.bind(this)(x)};\n          if ('unit' in value)\n            result[value.name]['unit'] = value.unit;\n        }\n      }\n    }\n    return result;\n  }\n};\n\nfunction parsePayload(payload) {\n  var decoded = decentlab_decoder.decode(payload);\n  Object.keys(decoded).map(function(key, index) { decoded[key] = decoded[key]['value'];});\n  return decoded;\n}",
  "sensors": [
    {
      "name": "moisture_at_level_0",
      "displayName": "Moisture at level 0",
      "type": "float"
    },
    {
      "name": "moisture_at_level_1",
      "displayName": "Moisture at level 1",
      "type": "float"
    },
    {
      "name": "moisture_at_level_2",
      "displayName": "Moisture at level 2",
      "type": "float"
    },
    {
      "name": "moisture_at_level_3",
      "displayName": "Moisture at level 3",
      "type": "float"
    },
    {
      "name": "moisture_at_level_4",
      "displayName": "Moisture at level 4",
      "type": "float"
    },
    {
      "name": "moisture_at_level_5",
      "displayName": "Moisture at level 5",
      "type": "float"
    },
    {
      "name": "temperature_at_level_0",
      "displayName": "Temperature at level 0",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_1",
      "displayName": "Temperature at level 1",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_2",
      "displayName": "Temperature at level 2",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_3",
      "displayName": "Temperature at level 3",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_4",
      "displayName": "Temperature at level 4",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_5",
      "displayName": "Temperature at level 5",
      "type": "tempC"
    },
    {
      "name": "salinity_at_level_0",
      "displayName": "Salinity at level 0",
      "type": "int"
    },
    {
      "name": "salinity_at_level_1",
      "displayName": "Salinity at level 1",
      "type": "int"
    },
    {
      "name": "salinity_at_level_2",
      "displayName": "Salinity at level 2",
      "type": "int"
    },
    {
      "name": "salinity_at_level_3",
      "displayName": "Salinity at level 3",
      "type": "int"
    },
    {
      "name": "salinity_at_level_4",
      "displayName": "Salinity at level 4",
      "type": "int"
    },
    {
      "name": "salinity_at_level_5",
      "displayName": "Salinity at level 5",
      "type": "int"
    },
    {
      "name": "moisture_at_level_6",
      "displayName": "Moisture at level 6",
      "type": "float"
    },
    {
      "name": "moisture_at_level_7",
      "displayName": "Moisture at level 7",
      "type": "float"
    },
    {
      "name": "moisture_at_level_8",
      "displayName": "Moisture at level 8",
      "type": "float"
    },
    {
      "name": "moisture_at_level_9",
      "displayName": "Moisture at level 9",
      "type": "float"
    },
    {
      "name": "moisture_at_level_10",
      "displayName": "Moisture at level 10",
      "type": "float"
    },
    {
      "name": "moisture_at_level_11",
      "displayName": "Moisture at level 11",
      "type": "float"
    },
    {
      "name": "temperature_at_level_6",
      "displayName": "Temperature at level 6",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_7",
      "displayName": "Temperature at level 7",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_8",
      "displayName": "Temperature at level 8",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_9",
      "displayName": "Temperature at level 9",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_10",
      "displayName": "Temperature at level 10",
      "type": "tempC"
    },
    {
      "name": "temperature_at_level_11",
      "displayName": "Temperature at level 11",
      "type": "tempC"
    },
    {
      "name": "salinity_at_level_6",
      "displayName": "Salinity at level 6",
      "type": "int"
    },
    {
      "name": "salinity_at_level_7",
      "displayName": "Salinity at level 7",
      "type": "int"
    },
    {
      "name": "salinity_at_level_8",
      "displayName": "Salinity at level 8",
      "type": "int"
    },
    {
      "name": "salinity_at_level_9",
      "displayName": "Salinity at level 9",
      "type": "int"
    },
    {
      "name": "salinity_at_level_10",
      "displayName": "Salinity at level 10",
      "type": "int"
    },
    {
      "name": "salinity_at_level_11",
      "displayName": "Salinity at level 11",
      "type": "int"
    },
    {
      "displayName": "Battery voltage",
      "name": "battery_voltage",
      "thresholds": [
        {
          "name": "Battery voltage is low",
          "type": "lessthan",
          "warning": "2.2"
        }
      ],
      "type": "volts"
    }
  ],
  "updatedUTC": "2020-05-29T18:06:30.651Z",
  "version": "v1.0"
}